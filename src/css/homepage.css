@layer components {

    /* Sezione home */
    .home-section {
        @apply space-y-2;
    }

    .home-section-title {
        @apply text-2xl font-semibold;
    }

    /* Chips - Filtri per categoria */
    .home-chips-row {
        @apply sticky top-0 z-30 flex flex-wrap gap-2 justify-between bg-main_paper py-2;
    }

    .home-chip {
        @apply flex-1 min-w-0 inline-flex items-center justify-center gap-1
        rounded-2xl border-2 px-3 py-3 text-xs font-normal
        transition-all duration-150 ease-out
        active:scale-95 active:brightness-90
        shadow-sm;
        border-color: var(--color-border_color);
        background-color: var(--color-main_paper);
        color: var(--color-text_color);
    }

    .home-chip img {
        @apply transition-all duration-150 ease-out;
    }

    /* Stato attivo del chip - Cibo */
    .home-chip.active[data-category="food"] {
        @apply font-semibold text-sm;
        background: linear-gradient(135deg, rgba(245, 242, 235, 0.6) 0%, var(--color-category-food) 100%);
        border-color: rgba(227, 100, 20, 0.8);
        color: var(--color-text_color);
        box-shadow:
            0 4px 12px rgba(227, 100, 20, 0.35),
            0 2px 4px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .home-chip.active[data-category="food"] img {
        @apply scale-150;
    }

    /* Stato attivo del chip - Cultura */
    .home-chip.active[data-category="culture"] {
        @apply font-semibold text-sm;
        background: linear-gradient(135deg, rgba(245, 242, 235, 0.6) 0%, var(--color-category-culture) 100%);
        border-color: rgba(201, 162, 106, 0.8);
        color: var(--color-text_color);
        box-shadow:
            0 4px 12px rgba(201, 162, 106, 0.35),
            0 2px 4px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .home-chip.active[data-category="culture"] img {
        @apply scale-150;
    }

    /* Stato attivo del chip - Natura */
    .home-chip.active[data-category="nature"] {
        @apply font-semibold text-sm;
        background: linear-gradient(135deg, rgba(245, 242, 235, 0.6) 0%, var(--color-category-nature) 100%);
        border-color: rgba(28, 124, 84, 0.8);
        color: var(--color-text_color);
        box-shadow:
            0 4px 12px rgba(28, 124, 84, 0.35),
            0 2px 4px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .home-chip.active[data-category="nature"] img {
        @apply scale-150;
    }

    /* Stato attivo del chip - Mistero */
    .home-chip.active[data-category="mystery"] {
        @apply font-semibold text-sm;
        background: linear-gradient(135deg, rgba(245, 242, 235, 0.6) 0%, var(--color-category-mystery) 100%);
        border-color: rgba(91, 43, 130, 0.8);
        color: var(--color-text_color);
        box-shadow:
            0 4px 12px rgba(91, 43, 130, 0.35),
            0 2px 4px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .home-chip.active[data-category="mystery"] img {
        @apply scale-150;
    }


    /* SPOTS SALVATI */
    .vedi-tutti-button {
        @apply text-xs font-bold underline underline-offset-2
        transition-all duration-150 ease-out
        active:opacity-70;
        color: var(--color-primary_color);
        border: none;
        background: none;
        padding: 0;
    }

    /* =========================
       CAROSELLO SWIPE (SALVATI)
       ========================= */

    /* area swipe edge-to-edge come app */
    .saved-swipe {
        @apply -mx-5;
    }

    /* track orizzontale scrollabile con snap */
    .saved-swipe-track {
        @apply flex gap-4 overflow-x-auto px-5 pb-1 scroll-smooth;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        flex-wrap: nowrap;
        margin-left: 1rem;
    }

    /* card del carosello: piccolo */
    .spot-card--saved {
        @apply shrink-0 rounded-xl overflow-hidden
        transition-all duration-150 ease-out
        active:scale-95 active:brightness-95
        shadow-md;
        scroll-snap-align: start;
        width: 50%;
        max-width: 110px;
        max-height: 130px;
        aspect-ratio: auto;
        height: 130px;
        flex-shrink: 0;
    }

    .spot-card--saved:active {
        box-shadow: 0 2px 6px var(--color-primary_color) inset;
    }

    .saved-swipe-track.is-dragging {
        @apply cursor-grabbing;
    }

    /* Media card - immagine */
    .spot-card-media {
        @apply relative w-full bg-black/5 overflow-hidden rounded-t-lg;
    }

    /* Contenitore immagine con dimensioni fisse */
    .spot-image-container {
        @apply relative bg-border_color overflow-hidden;
    }

    /* Dimensioni immagine per card GRANDE (nearby) */
    .spot-card--nearby .spot-image-container {
        @apply w-[220px] h-[150px];
    }

    /* Dimensioni immagine per card PICCOLO (saved, toprated) */
    .spot-card--saved .spot-image-container,
    .spot-card--toprated .spot-image-container {
        @apply w-[110px] h-[85px];
    }

    .spot-card-image {
        @apply w-full h-full object-cover;
    }

    .spot-card-media-placeholder {
        @apply absolute inset-0 grid place-items-center text-2xl text-text_color/60;
    }

    .spot-card-bookmark {
        @apply absolute top-1 right-1 w-8 h-8 rounded-lg
        grid place-items-center active:scale-95 transition text-text_color
        shadow-md backdrop-blur-sm;
    }

    /* Bookmark ridotto per card piccoli */
    .spot-card--saved .spot-card-bookmark,
    .spot-card--toprated .spot-card-bookmark {
        @apply w-8 h-10 top-0 right-0 shadow-md;
    }

    .spot-card-body {
        @apply p-3 flex flex-col justify-center items-center bg-main_paper text-center
        bg-gradient-to-t from-primary_color/40 to-transparent;
    }

    /* Padding ridotto per card piccoli */
    .spot-card--saved .spot-card-body,
    .spot-card--toprated .spot-card-body {
        @apply p-2 text-center flex flex-col justify-center items-center
        bg-gradient-to-t from-primary_color/30 to-transparent;
    }

    /* Gradiente per categoria Cibo */
    .spot-card--saved[data-category="food"] .spot-card-body {
        background: linear-gradient(to top, rgba(227, 100, 20, 0.4) 0%, transparent 100%);
    }

    /* Gradiente per categoria Cultura */
    .spot-card--saved[data-category="culture"] .spot-card-body {
        background: linear-gradient(to top, rgba(201, 162, 106, 0.4) 0%, transparent 100%);
    }

    /* Gradiente per categoria Natura */
    .spot-card--saved[data-category="nature"] .spot-card-body {
        background: linear-gradient(to top, rgba(28, 124, 84, 0.4) 0%, transparent 100%);
    }

    /* Gradiente per categoria Mistero */
    .spot-card--saved[data-category="mystery"] .spot-card-body {
        background: linear-gradient(to top, rgba(91, 43, 130, 0.4) 0%, transparent 100%);
    }

    .spot-card-title {
        @apply text-sm font-semibold leading-tight line-clamp-2 text-text_color text-center;
        text-shadow: 0 1px 3px rgba(28, 124, 84, 0.3);
    }

    /* Font ridotto per card piccoli */
    .spot-card--saved .spot-card-title,
    .spot-card--toprated .spot-card-title {
        @apply text-xs font-semibold text-center line-clamp-2 overflow-hidden text-text_color;
        word-break: break-word;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .spot-card-meta {
        @apply text-xs text-text_color/70 flex items-center gap-1 flex-wrap;
    }

    /* Meta ridotto per card piccoli */
    .spot-card--saved .spot-card-meta,
    .spot-card--toprated .spot-card-meta {
        @apply text-[10px] text-text_color/60;
    }

    /* Nascondi meta per card salvati */
    .spot-card--saved .spot-card-meta {
        @apply hidden;
    }

    .meta-item {
        @apply inline-flex items-center gap-0.5;
    }

    .meta-sep {
        @apply opacity-60;
    }

    .spot-card-rating {
        @apply text-xs font-semibold text-text_color;
    }

    /* Rating ridotto per card piccoli */
    .spot-card--saved .spot-card-rating,
    .spot-card--toprated .spot-card-rating {
        @apply text-[10px] font-bold;
    }

    /* Nascondi rating per card salvati */
    .spot-card--saved .spot-card-rating {
        @apply hidden;
    }

    /* =========================
       CAROSELLO SWIPE (NEARBY)
       ========================= */

    /* area swipe edge-to-edge come app */
    .nearby-swipe {
        @apply -mx-5;
    }

    /* track orizzontale scrollabile con snap */
    .nearby-swipe-track {
        @apply flex gap-4 overflow-x-auto px-5 pb-1 scroll-smooth;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        flex-wrap: nowrap;
        margin-left: 1rem;
    }

    /* card del carosello: grande + peek della successiva */
    .spot-card--nearby {
        @apply shrink-0;
        scroll-snap-align: start;
        width: 70%;
        max-width: 220px;
        aspect-ratio: 1 / 1;
        flex-shrink: 0;
    }

    .nearby-swipe-track.is-dragging {
        @apply cursor-grabbing;
    }

    /* =========================
       CAROSELLO SWIPE (TOP RATED)
       ========================= */

    /* area swipe edge-to-edge come app */
    .toprated-swipe {
        @apply -mx-5;
    }

    /* track orizzontale scrollabile con snap */
    .toprated-swipe-track {
        @apply flex gap-4 overflow-x-auto px-5 pb-1 scroll-smooth;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        flex-wrap: nowrap;
        margin-left: 1rem;
    }

    /* card del carosello: piccolo */
    .spot-card--toprated {
        @apply shrink-0;
        scroll-snap-align: start;
        width: 60%;
        max-width: 160px;
        aspect-ratio: 1 / 1;
        flex-shrink: 0;
    }

    .toprated-swipe-track.is-dragging {
        @apply cursor-grabbing;
    }

    /* =========================
       CAROSELLO VERTICALE
       ========================= */

    .vertical-carousel {
        @apply h-[190px] overflow-hidden rounded-lg;
    }

    .vertical-carousel-track {
        @apply flex flex-col gap-3 overflow-y-auto h-full scroll-smooth;
        scroll-snap-type: y mandatory;
        -webkit-overflow-scrolling: touch;
    }

    .vertical-carousel-track::-webkit-scrollbar {
        width: 4px;
    }

    .vertical-carousel-track::-webkit-scrollbar-track {
        background: transparent;
    }

    .vertical-carousel-track::-webkit-scrollbar-thumb {
        background: var(--color-border_color);
        border-radius: 2px;
    }

    /* Item verticale */
    .vertical-carousel-item {
        @apply flex gap-2 p-2 bg-white rounded-lg shrink-0;
        scroll-snap-align: start;
        min-height: 70px;
        border: 1px solid var(--color-border_color);
    }

    .vertical-item-image {
        @apply relative shrink-0 w-16 h-16 rounded-lg overflow-hidden bg-border_color;
    }

    .vertical-item-image img {
        @apply w-full h-full object-cover;
    }

    .vertical-item-content {
        @apply flex-1 flex flex-col justify-between relative pr-12;
    }

    .vertical-item-header {
        @apply flex items-center gap-3 w-full;
    }

    .vertical-item-title {
        @apply text-base font-semibold leading-tight line-clamp-1 flex-1;
    }

    .vertical-item-rating {
        @apply text-base font-semibold text-text_color flex-shrink-0;
    }

    .vertical-item-meta {
        @apply text-xs text-text_color/70 flex items-center gap-1 flex-wrap;
    }

    .vertical-item-bookmark {
        @apply absolute top-2 right-2 w-6 h-6 rounded-lg grid place-items-center active:scale-95 transition;
    }

    /* Carousels View All Pages. */

    .vertical-carousel.h-carousel-view-all {
        @apply h-[85dvh];
    }

    .vertical-carousel.h-carousel-section {
        @apply h-[70dvh];
    }

    .vertical-carousel.h-carousel-home {
        @apply h-[55dvh];
    }

    /* ================================
       ANIMAZIONI VIEW-ALL-SAVED
       ================================ */

    @keyframes slideInRight {
        from {
            transform: translateX(-100%);
        }
        to {
            transform: translateX(0);
        }
    }

    @keyframes slideOutRight {
        from {
            transform: translateX(0);
        }
        to {
            transform: translateX(100%);
        }
    }

    #main.view-all-saved-enter {
        animation: slideInRight 0.3s ease-out;
        will-change: transform;
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
    }

    #main.view-all-saved-exit {
        animation: slideOutRight 0.2s ease-in forwards;
        will-change: transform;
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
    }

}
