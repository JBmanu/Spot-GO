@layer components {
  .spot-detail-wrapper {
    @apply flex flex-col w-full min-h-screen overflow-hidden;
    background: linear-gradient(
            180deg,
            var(--color-main_paper) 0%,
            rgba(28, 124, 84, 0.015) 100%
    );
  }

  .spot-detail-wrapper[data-category="food"] {
    background:
            radial-gradient(circle at 20% 0%, rgba(227, 100, 20, 0.10) 0%, transparent 55%),
            linear-gradient(180deg, var(--color-main_paper) 0%, rgba(227, 100, 20, 0.03) 100%);
    --category-color-r: 227; --category-color-g: 100; --category-color-b: 20;
    --category-color-dark-r: 201; --category-color-dark-g: 80; --category-color-dark-b: 10;
  }

  .spot-detail-wrapper[data-category="culture"] {
    background:
            radial-gradient(circle at 20% 0%, rgba(201, 162, 106, 0.10) 0%, transparent 55%),
            linear-gradient(180deg, var(--color-main_paper) 0%, rgba(201, 162, 106, 0.03) 100%);
    --category-color-r: 201; --category-color-g: 162; --category-color-b: 106;
    --category-color-dark-r: 175; --category-color-dark-g: 140; --category-color-dark-b: 80;
  }

  .spot-detail-wrapper[data-category="nature"] {
    background:
            radial-gradient(circle at 20% 0%, rgba(28, 124, 84, 0.12) 0%, transparent 55%),
            linear-gradient(180deg, var(--color-main_paper) 0%, rgba(28, 124, 84, 0.03) 100%);
    --category-color-r: 28; --category-color-g: 124; --category-color-b: 84;
    --category-color-dark-r: 13; --category-color-dark-g: 90; --category-color-dark-b: 63;
  }

  .spot-detail-wrapper[data-category="mystery"] {
    background:
            radial-gradient(circle at 20% 0%, rgba(91, 43, 130, 0.10) 0%, transparent 55%),
            linear-gradient(180deg, var(--color-main_paper) 0%, rgba(91, 43, 130, 0.03) 100%);
    --category-color-r: 91; --category-color-g: 43; --category-color-b: 130;
    --category-color-dark-r: 70; --category-color-dark-g: 30; --category-color-dark-b: 110;
  }

  .spot-detail-wrapper::-webkit-scrollbar { display: none; }
  .spot-detail-wrapper { -ms-overflow-style: none; scrollbar-width: none; }

  .spot-detail-container {
    @apply flex-1 overflow-visible max-h-none;
  }

  .spot-glass {
    background: rgba(255, 255, 255, 0.56);
    border: 1px solid rgba(255, 255, 255, 0.28);
    box-shadow:
            0 16px 44px rgba(0, 0, 0, 0.06),
            inset 0 1px 0 rgba(255, 255, 255, 0.65);
    backdrop-filter: blur(14px) saturate(150%);
    -webkit-backdrop-filter: blur(14px) saturate(150%);
  }

  .spot-detail-title-container {
    @apply sticky top-0 z-30 px-4 py-3 flex justify-between items-center gap-3;
    position: sticky;
    background: rgba(255, 255, 255, 0.42);
    backdrop-filter: blur(22px) saturate(170%);
    -webkit-backdrop-filter: blur(22px) saturate(170%);
    border-bottom: 1px solid rgba(255, 255, 255, 0.38);
    box-shadow:
            0 10px 30px rgba(0,0,0,0.05),
            inset 0 1px 0 rgba(255,255,255,0.65);
    position: sticky;
    position: sticky;
    position: sticky;
    position: sticky;
  }

  .spot-detail-title-container { position: sticky; }
  .spot-detail-title-container { position: sticky; }
  .spot-detail-title-container { position: sticky; }

  .spot-detail-title-container { position: sticky; top: 0; }
  .spot-detail-title-container { position: sticky; }
  .spot-detail-title-container { position: sticky; }

  .spot-detail-title-container { position: sticky; }
  .spot-detail-title-container { @apply relative; }

  .spot-detail-title-container::before {
    content: "";
    @apply absolute inset-0 pointer-events-none;
    background:
            radial-gradient(
                    circle at 18% 20%,
                    rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.14) 0%,
                    transparent 55%
            ),
            linear-gradient(180deg, rgba(255,255,255,0.55) 0%, rgba(255,255,255,0.22) 100%);
    opacity: 0.95;
  }

  .spot-detail-title-section {
    @apply flex-1 flex flex-col gap-2 items-start relative;
    z-index: 1;
  }

  .spot-detail-title {
    @apply text-3xl font-black leading-tight m-0 capitalize;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.01em;
    color: rgb(var(--category-color-r), var(--category-color-g), var(--category-color-b));
    text-shadow:
            0 1px 0 rgba(255,255,255,0.55),
            0 10px 26px rgba(0,0,0,0.06);
  }

  .spot-detail-rating {
    @apply flex items-center gap-2 text-xs font-black px-3 py-2 shrink-0 rounded-2xl relative;
    z-index: 1;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.05em;
    color: rgba(17, 24, 39, 0.9);
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.22);
    box-shadow:
            0 10px 24px rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.10),
            inset 0 1px 0 rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(12px) saturate(160%);
    -webkit-backdrop-filter: blur(12px) saturate(160%);
  }

  .rating-star {
    @apply w-[16px] h-[16px];
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.10));
  }

  .spot-detail-bookmark-button {
    @apply fixed right-4 top-[92px] w-12 h-12 flex items-center justify-center rounded-2xl z-40;
    background: rgba(255, 255, 255, 0.62);
    border: 1px solid rgba(255, 255, 255, 0.32);
    box-shadow:
            0 16px 40px rgba(0,0,0,0.10),
            inset 0 1px 0 rgba(255,255,255,0.7);
    backdrop-filter: blur(14px) saturate(160%);
    -webkit-backdrop-filter: blur(14px) saturate(160%);
    transition: transform 180ms ease, box-shadow 180ms ease;
  }

  .spot-detail-bookmark-button::after {
    content: "";
    @apply absolute inset-0 rounded-2xl pointer-events-none;
    border: 1px solid rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.25);
    opacity: 0.9;
  }

  .spot-detail-bookmark-button:active {
    transform: scale(0.96);
    box-shadow:
            0 10px 26px rgba(0,0,0,0.10),
            inset 0 1px 0 rgba(255,255,255,0.7);
  }

  .spot-detail-bookmark-button .bookmark-icon {
    @apply w-[24px] h-[24px];
    filter: saturate(1.2) drop-shadow(0 2px 4px rgba(0,0,0,0.12));
  }

  .spot-detail-header {
    @apply relative w-full h-72 overflow-hidden;
    border-bottom: 1px solid rgba(255, 255, 255, 0.35);
  }

  .spot-detail-header::before {
    content: "";
    @apply absolute inset-0 pointer-events-none;
    background:
            radial-gradient(circle at 22% 14%, rgba(255,255,255,0.28) 0%, transparent 55%),
            linear-gradient(180deg, rgba(0,0,0,0.10) 0%, rgba(0,0,0,0.00) 60%),
            linear-gradient(
                    135deg,
                    rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.12) 0%,
                    rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.04) 100%
            );
  }

  .spot-detail-image-container { @apply relative w-full h-full overflow-hidden; }
  .spot-detail-image {
    @apply w-full h-full block;
    object-fit: cover;
    filter: contrast(1.03) brightness(1.03);
    transform: scale(1.02);
  }

  .spot-detail-description-compact {
    @apply px-4 -mt-6 relative z-10;
  }

  .spot-detail-description-compact .spot-detail-description {
    @apply m-0 p-4 rounded-3xl text-sm leading-relaxed;
    font-family: "Montserrat", sans-serif;
    color: rgba(17, 24, 39, 0.82);
    background: rgba(255, 255, 255, 0.60);
    border: 1px solid rgba(255, 255, 255, 0.30);
    box-shadow:
            0 16px 44px rgba(0,0,0,0.06),
            inset 0 1px 0 rgba(255,255,255,0.7);
    backdrop-filter: blur(14px) saturate(150%);
    -webkit-backdrop-filter: blur(14px) saturate(150%);
  }

  .spot-missions-banner-wrapper {
    @apply px-4 pt-3 pb-1;
    background: transparent;
    border: 0;
    box-shadow: none;
  }

  .spot-detail-missions-banner {
    @apply w-full flex items-center justify-between gap-3 rounded-3xl px-4 py-3 relative overflow-hidden;
    background: rgba(255, 255, 255, 0.58);
    border: 1px solid rgba(255, 255, 255, 0.30);
    box-shadow:
            0 14px 38px rgba(0,0,0,0.06),
            inset 0 1px 0 rgba(255,255,255,0.7);
    backdrop-filter: blur(14px) saturate(160%);
    -webkit-backdrop-filter: blur(14px) saturate(160%);
  }

  .spot-detail-missions-banner::before {
    content: "";
    @apply absolute inset-0 pointer-events-none;
    background: radial-gradient(
            circle at 16% 30%,
            rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.14) 0%,
            transparent 55%
    );
  }

  .missions-banner-content {
    @apply flex items-center gap-2 relative;
    z-index: 1;
    font-family: "Montserrat", sans-serif;
    color: rgba(17, 24, 39, 0.82);
  }

  .missions-icon { @apply w-5 h-5 shrink-0; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.10)); }

  .missions-text {
    @apply text-xs font-semibold whitespace-nowrap;
    letter-spacing: 0.02em;
  }

  .missions-toggle-button {
    @apply w-10 h-10 grid place-items-center rounded-2xl relative;
    z-index: 1;
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.18);
    backdrop-filter: blur(12px) saturate(160%);
    -webkit-backdrop-filter: blur(12px) saturate(160%);
    transition: transform 180ms ease;
  }

  .missions-toggle-button:active { transform: scale(0.96); }

  .toggle-arrow {
    @apply w-5 h-5;
    opacity: 0.85;
    transition: transform 220ms ease;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.12));
  }

  .spot-detail-missions-banner.is-open .toggle-arrow { transform: rotate(90deg); }

  .spot-missions-details {
    @apply px-4 pt-2 pb-1;
    background: transparent;
    border: 0;
  }

  .missions-list { @apply grid grid-cols-2 gap-3 mt-3; }
  .mission-item { @apply relative; }

  .mission-banner {
    @apply w-full min-h-[64px] px-4 py-3 rounded-3xl text-xs font-black uppercase text-center flex items-center justify-center;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.05em;
    color: rgba(17, 24, 39, 0.82);
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(255, 255, 255, 0.30);
    box-shadow:
            0 14px 36px rgba(0,0,0,0.05),
            inset 0 1px 0 rgba(255,255,255,0.7);
    backdrop-filter: blur(14px) saturate(155%);
    -webkit-backdrop-filter: blur(14px) saturate(155%);
    transition: transform 180ms ease, box-shadow 180ms ease;
  }

  .mission-banner::before {
    content: "";
    @apply absolute inset-0 rounded-3xl pointer-events-none;
    border: 1px solid rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.18);
    opacity: 0.9;
  }

  .mission-banner:active {
    transform: scale(0.985);
    box-shadow: 0 10px 28px rgba(0,0,0,0.05), inset 0 1px 0 rgba(255,255,255,0.7);
  }

  .mission-banner.completed {
    color: rgba(17, 24, 39, 0.72);
    background: rgba(255, 255, 255, 0.50);
  }

  .mission-banner.completed::before { border-color: rgba(76, 175, 80, 0.30); }

  .spot-detail-info-detailed {
    @apply mx-4 mt-4 p-5 rounded-3xl flex flex-col gap-4 relative overflow-hidden;
    background: rgba(255, 255, 255, 0.58);
    border: 1px solid rgba(255, 255, 255, 0.30);
    box-shadow:
            0 18px 50px rgba(0,0,0,0.06),
            inset 0 1px 0 rgba(255,255,255,0.7);
    backdrop-filter: blur(16px) saturate(150%);
    -webkit-backdrop-filter: blur(16px) saturate(150%);
  }

  .spot-detail-info-detailed::before {
    content: "";
    @apply absolute inset-0 pointer-events-none;
    background: radial-gradient(circle at 18% 10%, rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.14) 0%, transparent 55%);
  }

  .info-row { @apply flex items-start gap-3 relative; z-index: 1; }

  .info-icon { @apply w-5 h-5 shrink-0 mt-px; opacity: 0.85; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.10)); }
  .info-content { @apply flex-1 flex flex-col gap-1; }

  .info-label {
    @apply text-[11px] font-black uppercase;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.07em;
    color: rgba(17, 24, 39, 0.45);
  }

  .info-value {
    @apply text-sm font-bold;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.01em;
    color: rgba(17, 24, 39, 0.82);
  }

  .info-label-with-distance { @apply flex items-center justify-between gap-2; }
  .info-distance-label { @apply flex items-center gap-1 text-xs font-semibold; color: rgba(17,24,39,0.65); }
  .info-distance-label .icon-mini { @apply w-[13px] h-[13px]; }

  .spot-reviews-header { @apply px-4 pt-6 pb-0 mt-2; background: transparent; border-top: 0; }
  .spot-reviews-header-actions { @apply flex items-end justify-between gap-3 w-full; }

  .spot-add-review-button {
    @apply px-4 py-3 rounded-2xl text-xs font-black uppercase;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.04em;
    color: rgba(17, 24, 39, 0.86);
    background: rgba(255, 255, 255, 0.60);
    border: 1px solid rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.20);
    box-shadow:
            0 14px 38px rgba(0,0,0,0.06),
            inset 0 1px 0 rgba(255,255,255,0.75);
    backdrop-filter: blur(14px) saturate(160%);
    -webkit-backdrop-filter: blur(14px) saturate(160%);
    transition: transform 180ms ease;
  }

  .spot-add-review-button:active { transform: scale(0.98); }

  .spot-view-all-reviews-button {
    @apply px-1 py-2 text-xs font-bold underline;
    font-family: "Montserrat", sans-serif;
    color: rgb(var(--category-color-dark-r), var(--category-color-dark-g), var(--category-color-dark-b));
    text-decoration-thickness: 2px;
    text-underline-offset: 4px;
    background: transparent;
  }

  .spot-view-all-reviews-button:active { transform: scale(0.98); }

  .spot-reviews-carousel-container { @apply w-full; }

  .spot-reviews-carousel-wrapper {
    @apply flex overflow-x-auto overflow-y-hidden w-full gap-4 py-5 px-4;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  .spot-reviews-carousel-wrapper::-webkit-scrollbar { display: none; }
  .spot-reviews-carousel-track { @apply flex gap-4; }

  .spot-review-carousel-item {
    @apply flex-shrink-0;
    flex: 0 0 calc(100% - 72px);
    scroll-snap-align: start;
    scroll-snap-stop: always;
  }

  .spot-review-item {
    @apply p-4 rounded-3xl h-full flex flex-col gap-3 relative overflow-hidden;
    background: rgba(255, 255, 255, 0.58);
    border: 1px solid rgba(255, 255, 255, 0.30);
    box-shadow:
            0 16px 44px rgba(0,0,0,0.06),
            inset 0 1px 0 rgba(255,255,255,0.7);
    backdrop-filter: blur(16px) saturate(150%);
    -webkit-backdrop-filter: blur(16px) saturate(150%);
  }

  .spot-review-item::before {
    content: "";
    @apply absolute inset-0 pointer-events-none;
    background: radial-gradient(circle at 18% 10%, rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.12) 0%, transparent 55%);
  }

  .spot-review-header { @apply flex justify-between items-center gap-2 relative; z-index: 1; }

  .spot-review-author {
    @apply font-black text-sm capitalize;
    font-family: "Montserrat", sans-serif;
    color: rgba(17, 24, 39, 0.86);
    letter-spacing: 0.02em;
  }

  .spot-review-rating {
    @apply flex items-center gap-1 text-xs font-black px-3 py-1.5 rounded-2xl whitespace-nowrap relative;
    z-index: 1;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.03em;
    color: rgba(17, 24, 39, 0.86);
    background: rgba(255, 255, 255, 0.60);
    border: 1px solid rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.20);
    backdrop-filter: blur(12px) saturate(160%);
    -webkit-backdrop-filter: blur(12px) saturate(160%);
  }

  .spot-review-text {
    @apply text-sm leading-relaxed m-0 font-medium flex-1 relative;
    z-index: 1;
    color: rgba(17, 24, 39, 0.78);
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .spot-reviews-carousel-wrapper.is-dragging { scroll-behavior: auto; @apply cursor-grabbing; }

  .spot-detail-actions {
    @apply sticky bottom-0 z-50 w-full p-3 flex gap-3 relative;
    background: rgba(255, 255, 255, 0.62);
    border-top: 1px solid rgba(255, 255, 255, 0.35);
    box-shadow: 0 -18px 50px rgba(0,0,0,0.08);
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
  }

  .spot-detail-actions::before {
    content: "";
    @apply absolute inset-0 pointer-events-none;
    background: radial-gradient(circle at 20% 0%, rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.12) 0%, transparent 55%);
    opacity: 0.95;
  }

  .spot-detail-action-button {
    @apply flex-1 flex items-center justify-center gap-3 px-5 py-4 rounded-3xl text-xs font-black uppercase relative overflow-hidden;
    z-index: 1;
    font-family: "Montserrat", sans-serif;
    letter-spacing: 0.05em;
    color: rgba(17, 24, 39, 0.86);
    background: rgba(255, 255, 255, 0.62);
    border: 1px solid rgba(255, 255, 255, 0.34);
    box-shadow:
            0 14px 40px rgba(0,0,0,0.06),
            inset 0 1px 0 rgba(255,255,255,0.75);
    backdrop-filter: blur(16px) saturate(160%);
    -webkit-backdrop-filter: blur(16px) saturate(160%);
    transition: transform 180ms ease, box-shadow 180ms ease;
  }

  .spot-detail-action-button::before {
    content: "";
    @apply absolute inset-0 pointer-events-none;
    border: 1px solid rgba(var(--category-color-r), var(--category-color-g), var(--category-color-b), 0.18);
    border-radius: 24px;
    opacity: 0.95;
  }

  .spot-detail-action-button:active {
    transform: scale(0.985);
    box-shadow:
            0 10px 28px rgba(0,0,0,0.06),
            inset 0 1px 0 rgba(255,255,255,0.75);
  }

  .spot-detail-action-button .icon-mini {
    @apply w-[22px] h-[22px];
    opacity: 0.95;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.10));
  }

  .spot-detail-visit-button.visited { border-color: rgba(76, 175, 80, 0.32); }
}
